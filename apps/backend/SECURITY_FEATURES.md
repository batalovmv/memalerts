# –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –∫–∞–∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–∂–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### JWT —Ç–æ–∫–µ–Ω—ã
- **–ò–∑–æ–ª—è—Ü–∏—è –±–µ—Ç–∞/–ø—Ä–æ–¥–∞–∫—à–µ–Ω**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ `JWT_SECRET` –¥–ª—è –±–µ—Ç–∞ –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–π
  - Production: `JWT_SECRET`
  - Beta: `JWT_SECRET_BETA`
  - –§–∞–π–ª: `.github/workflows/ci-cd.yml`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: JWT_SECRET –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ httpOnly cookies —Å `secure` –∏ `sameSite` —Ñ–ª–∞–≥–∞–º–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- **Channel ownership validation**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å/–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ–º—ã —Ç–æ–ª—å–∫–æ –≤ —Å–≤–æ–∏ –∫–∞–Ω–∞–ª—ã
  - –§–∞–π–ª: `src/controllers/submissionController.ts`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: `user.channelId === channelId`
- **Beta access control**: Middleware –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ beta –æ–∫—Ä—É–∂–µ–Ω–∏—é
  - –§–∞–π–ª: `src/middleware/betaAccess.ts`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ –Ω–∞ beta –¥–æ–º–µ–Ω–µ

### Middleware
- **authenticate**: –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `req.userId` –∏ `req.channelId`
  - –§–∞–π–ª: `src/middleware/auth.ts`
- **requireBetaAccess**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ beta –æ–∫—Ä—É–∂–µ–Ω–∏—é
  - –§–∞–π–ª: `src/middleware/betaAccess.ts`

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

### CSRF (Cross-Site Request Forgery)
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ Origin/Referer headers –¥–ª—è state-changing –æ–ø–µ—Ä–∞—Ü–∏–π (POST, PUT, DELETE, PATCH)
- **–§–∞–π–ª**: `src/middleware/csrf.ts`
- **–ò—Å–∫–ª—é—á–µ–Ω–∏—è**: Webhooks (–∏—Å–ø–æ–ª—å–∑—É—é—Ç HMAC), health checks, auth endpoints
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CSRF –ø–æ–ø—ã—Ç–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ security events

### Path Traversal Protection
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–µ–π
- **–§–∞–π–ª—ã**: 
  - `src/utils/pathSecurity.ts` - —É—Ç–∏–ª–∏—Ç—ã (`sanitizeFilename`, `validatePathWithinDirectory`, `safePathJoin`)
  - `src/middleware/upload.ts` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤
  - `src/controllers/adminController.ts` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–æ–≤
  - `src/utils/fileHash.ts` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø—É—Ç—è–º–∏ —Ñ–∞–π–ª–æ–≤

### SQL Injection Protection
- **Prisma ORM**: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **$queryRaw**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å Prisma template literals (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
  - –ü—Ä–∏–º–µ—Ä: `prisma.$queryRaw\`SELECT * FROM "Channel" WHERE slug = ${slug}\``
- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: –í—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `$queryRaw` –±–µ–∑–æ–ø–∞—Å–Ω—ã

### XSS (Cross-Site Scripting) Protection
- **Content Security Policy (CSP)**: –ù–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ Helmet
  - –§–∞–π–ª: `src/index.ts`
  - –î–∏—Ä–µ–∫—Ç–∏–≤—ã –¥–ª—è script, style, img, media, connect, frame, worker, font
  - –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏: self, Twitch CDN, Google Fonts
- **Helmet**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - `crossOriginEmbedderPolicy: false` (–¥–ª—è Twitch embeds)
  - CSP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç XSS

### File Upload Security
- **MIME type validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞
- **Magic bytes validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ (–Ω–µ —Ç–æ–ª—å–∫–æ MIME type)
  - –§–∞–π–ª: `src/utils/fileTypeValidator.ts`
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP4, WebM, AVI, QuickTime/MOV, Matroska/MKV
- **File size limits**: 
  - –ú–∞–∫—Å–∏–º—É–º 50MB –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (Submit.tsx)
- **Path sanitization**: –í—Å–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- **File deduplication**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SHA-256 —Ö–µ—à–µ–π –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
  - –§–∞–π–ª: `src/utils/fileHash.ts`

## üìä Rate Limiting

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç–µ—Ä
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 15 –º–∏–Ω—É—Ç –Ω–∞ IP
- **–§–∞–π–ª**: `src/middleware/rateLimit.ts`
- **Whitelist**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–∏—Å–∫–∞ IP –∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ `RATE_LIMIT_WHITELIST_IPS`

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏–º–∏—Ç–µ—Ä—ã
- **activateMemeLimiter**: 1 –∑–∞–ø—Ä–æ—Å –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã
- **uploadLimiter**: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 1 –º–∏–Ω—É—Ç—É

### IP Detection
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: CF-Connecting-IP > X-Real-IP > X-Forwarded-For > socket.remoteAddress
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: Cloudflare, Nginx proxy
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ —Å–æ–±—ã—Ç–∏—è rate limiting –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

## üìù –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–£—Ç–∏–ª–∏—Ç–∞**: `src/utils/auditLogger.ts`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - `logAuthEvent` - —Å–æ–±—ã—Ç–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (login, logout, login_failed)
  - `logFileUpload` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ (success/failure)
  - `logAdminAction` - –∞–¥–º–∏–Ω—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (approve, reject, update, delete)
  - `logMemeActivation` - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –º–µ–º–æ–≤
  - `logSecurityEvent` - —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (CSRF, rate limit, unauthorized access, etc.)

### –•—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –¢–∞–±–ª–∏—Ü–∞ `AuditLog` –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
- **–ö–æ–Ω—Å–æ–ª—å**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ**: IP –∞–¥—Ä–µ—Å, User Agent, timestamp, success/failure, –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫

### –õ–æ–≥–∏—Ä—É–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (—É—Å–ø–µ—à–Ω–∞—è/–Ω–µ—É—Å–ø–µ—à–Ω–∞—è)
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- –ê–¥–º–∏–Ω—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (approve/reject submissions, update memes, adjust wallets)
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è –º–µ–º–æ–≤
- –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (CSRF blocked, rate limit exceeded, unauthorized access, file validation failed, path traversal attempts)

## üóÑÔ∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ù–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Zod schemas**: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –§–∞–π–ª: `src/shared/schemas.ts`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: submissions, memes, channel settings, etc.

### –ù–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **CHECK constraints**: –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
  - –§–∞–π–ª: `prisma/migrations/20250117000000_add_database_constraints/migration.sql`
  - Constraints –¥–ª—è:
    - Wallet: `balance >= 0`
    - Promotion: `discountPercent` 0-100, `endDate > startDate`
    - Channel: `coinPerPointRatio > 0`, –≤–∞–ª–∏–¥–∞—Ü–∏—è hex —Ü–≤–µ—Ç–æ–≤
    - Meme: `priceCoins >= 0`, `durationMs > 0`, –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ —Ç–∏–ø–æ–≤
    - Redemption: `pointsSpent > 0`, `coinsGranted >= 0`
    - MemeActivation: `coinsSpent >= 0`
    - User: –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–æ–ª–µ–π
    - FileHash: `referenceCount > 0`, `fileSize >= 0`

## üåê CORS –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### CORS Configuration
- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã**: –¢–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã (beta –∏ production)
- **–§–∞–π–ª**: `src/index.ts` - `getAllowedOrigins()`
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**: CORS headers –≤ Nginx –¥–ª—è `/uploads/`
  - –§–∞–π–ª: `.github/scripts/setup-nginx-full.sh`
  - –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ: production –∏ beta –¥–æ–º–µ–Ω—ã

## ‚öôÔ∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `DATABASE_URL` - —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞
- `JWT_SECRET` - –¥–ª—è production
- `JWT_SECRET_BETA` - –¥–ª—è beta (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `TWITCH_CLIENT_ID`
- `TWITCH_CLIENT_SECRET`
- `TWITCH_EVENTSUB_SECRET`

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `DOMAIN` - —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞ –¥–æ–º–µ–Ω–∞
- `WEB_URL` - —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π URL —Ñ–æ—Ä–º–∞—Ç–∞
- `TWITCH_CALLBACK_URL` - —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π URL —Ñ–æ—Ä–º–∞—Ç–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ DATABASE_URL (port, schema parameter)
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ WEB_URL –∏ TWITCH_CALLBACK_URL
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ DOMAIN
- –§–∞–π–ª: `src/index.ts` - —Ñ—É–Ω–∫—Ü–∏—è `startServer()`

## üîí Webhook Security

### HMAC Verification
- **Twitch EventSub**: –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –≤—Å–µ—Ö webhook –∑–∞–ø—Ä–æ—Å–æ–≤
- **–§–∞–π–ª**: `src/controllers/webhookController.ts`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞**: Signature, timestamp (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10 –º–∏–Ω—É—Ç)

## üì¶ –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

### Deduplication
- **SHA-256 —Ö–µ—à–∏**: –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤
- **FileHash —Ç–∞–±–ª–∏—Ü–∞**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ñ–∞–π–ª—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**: –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ `referenceCount = 0`

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- **–ü—É—Ç—å**: `/opt/memalerts-backend/uploads/` (production)
- **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è**: –í—Å–µ –ø—É—Ç–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ**: Beta –∏ production –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (–º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤ –±—É–¥—É—â–µ–º)

## üöÄ CI/CD Security

### GitHub Secrets
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ GitHub Secrets
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è beta –∏ production
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `.env` —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

### Nginx Configuration
- SSL/TLS —á–µ—Ä–µ–∑ Cloudflare Origin Certificate
- CORS headers –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- Proxy headers –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IP
- Timeouts –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (5 –º–∏–Ω—É—Ç –¥–ª—è uploads)

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ `authenticate` middleware?
- [ ] **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ª–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (channel ownership, role)?
- [ ] **CSRF**: –ó–∞—â–∏—â–µ–Ω—ã –ª–∏ state-changing –æ–ø–µ—Ä–∞—Ü–∏–∏ (POST/PUT/DELETE)?
- [ ] **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ Zod schemas –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?
- [ ] **Rate limiting**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π rate limiter?
- [ ] **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ `auditLogger`?
- [ ] **File uploads**: –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏:
  - [ ] Magic bytes validation
  - [ ] Path sanitization
  - [ ] File size limits
  - [ ] File deduplication (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] **SQL queries**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (Prisma)?
- [ ] **Error handling**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–∏ –æ—à–∏–±–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ (–±–µ–∑ —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)?
- [ ] **Environment variables**: –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è?

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å (PM2 logs)
- –ê—É–¥–∏—Ç-–ª–æ–≥–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DataDog/Grafana –¥–ª—è –º–µ—Ç—Ä–∏–∫
- –ê–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ failed logins, CSRF –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- Prisma Security: https://www.prisma.io/docs/guides/security
- OWASP Top 10: https://owasp.org/www-project-top-ten/
- Express Security Best Practices: https://expressjs.com/en/advanced/best-practice-security.html

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-01-17
**–í–µ—Ä—Å–∏—è**: 1.0

