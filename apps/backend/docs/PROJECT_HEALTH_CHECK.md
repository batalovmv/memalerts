# üîç MemAlerts Backend ‚Äî –ü–ª–∞–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞.

---

## 1Ô∏è‚É£ –°–±–æ—Ä–∫–∞ –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è

### 1.1 TypeScript –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
pnpm typecheck
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–µ–∑ –æ—à–∏–±–æ–∫ (exit code 0)
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (npm warns: Unknown env config entries)

### 1.2 –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
pnpm build
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ë–µ–∑ –æ—à–∏–±–æ–∫
- –ü–∞–ø–∫–∞ `dist/` –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- –í—Å–µ —Ñ–∞–π–ª—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK

### 1.3 Prisma –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
```bash
npx prisma generate
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** `@prisma/client` —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK

---

## 2Ô∏è‚É£ –õ–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 2.1 ESLint
```bash
pnpm lint
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- 0 –æ—à–∏–±–æ–∫ (errors)
- Warnings ‚â§ 500 (—Ç–µ–∫—É—â–∏–π –ª–∏–º–∏—Ç –¥–ª—è CI)
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK

### 2.2 Prettier
```bash
pnpm format:check
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ñ–∞–π–ª—ã –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK

---

## 3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

### 3.1 Dev-—Ä–µ–∂–∏–º (—Å hot-reload)
```bash
pnpm dev
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –õ–æ–≥: `Server started on port XXXX`
- –ù–µ—Ç `ERR_MODULE_NOT_FOUND`
- –ù–µ—Ç `Route.XXX() requires a callback function`
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (dev server started; health endpoints return ok)

### 3.2 Production-—Ä–µ–∂–∏–º
```bash
pnpm build && pnpm start
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ dev-—Ä–µ–∂–∏–º—É
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (NODE_ENV=production; health endpoints return ok)

---

## 4Ô∏è‚É£ Health-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

### 4.1 –ë–∞–∑–æ–≤—ã–π health
```bash
curl http://localhost:3001/health
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** `{ "status": "ok" }`
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (dev)

### 4.2 Readiness (–µ—Å–ª–∏ –µ—Å—Ç—å)
```bash
curl http://localhost:3001/healthz
curl http://localhost:3001/readyz
```
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (dev)

---

## 5Ô∏è‚É£ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### 5.1 –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
```bash
pnpm db:migrate:status
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (memalerts_test @ 5433; db push + migrate resolve baseline)

### 5.2 Prisma Studio (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
pnpm db:studio
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è UI, —Ç–∞–±–ª–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** SKIP (UI not checked)

---

## 6Ô∏è‚É£ –¢–µ—Å—Ç—ã

### 6.1 Unit/Integration —Ç–µ—Å—Ç—ã
```bash
pnpm test
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (TEST_DATABASE_URL_BASE set for test DB)

### 6.2 Coverage (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
pnpm test:ci
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** Coverage –Ω–µ –Ω–∏–∂–µ baseline
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** SKIP (base test run failed)

---

## 7Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π

### 7.1 Socket.IO
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ `ws://localhost:3001`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–±—ã—Ç–∏—è `join:channel`, `join:user`, `join:overlay`
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** SKIP (manual check not executed; join behavior covered by tests)

### 7.2 OAuth –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- Twitch, YouTube, VKVideo, Trovo, Kick, Discord
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (VKVIDEO_CLIENT_ID / VKVIDEO_CLIENT_SECRET present)

### 7.3 –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- POST `/submissions` —Å –≤–∏–¥–µ–æ-—Ñ–∞–π–ª–æ–º
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –≤ `uploads/`
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** SKIP (manual upload not executed)

---

## 8Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ VPS (production/beta)

### 8.1 SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```bash
ssh deploy@155.212.172.136
```
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK

### 8.2 –°—Ç–∞—Ç—É—Å PM2
```bash
pm2 status
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- `memalerts-api` - online (prod, –ø–æ—Ä—Ç 3001)
- `memalerts-api-beta` - online (beta, –ø–æ—Ä—Ç 3002)
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (prod + beta online)

### 8.3 –õ–æ–≥–∏
```bash
pm2 logs memalerts-api --lines 50
pm2 logs memalerts-api-beta --lines 50
```
**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –ù–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ—à–∏–±–æ–∫
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK (beta column ensured; error log timestamp stable)

### 8.4 Health –Ω–∞ VPS
```bash
curl http://localhost:3001/health   # prod
curl http://localhost:3002/health   # beta
```
**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** OK

---

## üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| # | –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ö–æ–º–∞–Ω–¥–∞ | –°—Ç–∞—Ç—É—Å |
|---|----------|---------|--------|
| 1 | TypeScript | `pnpm typecheck` | OK |
| 2 | –°–±–æ—Ä–∫–∞ | `pnpm build` | OK |
| 3 | Prisma | `npx prisma generate` | OK |
| 4 | ESLint | `pnpm lint` | OK |
| 5 | Prettier | `pnpm format:check` | OK |
| 6 | Dev-—Å–µ—Ä–≤–µ—Ä | `pnpm dev` | OK |
| 7 | Health | `curl /health` | OK (dev) |
| 8 | –ú–∏–≥—Ä–∞—Ü–∏–∏ | `pnpm db:migrate:status` | OK |
| 9 | –¢–µ—Å—Ç—ã | `pnpm test` | OK |
| 10 | PM2 (VPS) | `pm2 status` | OK |

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è)

### ESLint Warnings
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** ~960
- **–¢–∏–ø:** `@typescript-eslint/no-explicit-any`
- **–í–ª–∏—è–Ω–∏–µ:** –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É, –Ω–æ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å CI –ø—Ä–∏ `--max-warnings 500`

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏
- –§–∞–π–ª `tmp-runtime/api.err.log` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ä—ã–µ –æ—à–∏–±–∫–∏
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ

```bash
rm tmp-runtime/api.err.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2026-01-17
- Prettier: OK (`pnpm format:check` passed).
- Migrations: OK (memalerts_test @ 5433; db push + migrate resolve baseline).
- Tests: OK (all tests passed with TEST_DATABASE_URL_BASE).
- VPS beta logs: OK (aiProcessingStartedAt column ensured; no new error log updates).

---

## üöÄ Quick Start

–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ 2 –º–∏–Ω—É—Ç—ã:

```bash
# 1. –°–±–æ—Ä–∫–∞
pnpm build

# 2. –ó–∞–ø—É—Å–∫
pnpm start &

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ health
sleep 3 && curl http://localhost:3001/health

# 4. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pkill -f "node dist/index.js"
```

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-17*

